{% extends "base.html" %}

{% block title %}{{ paper.title }} - arXiv è®ºæ–‡æµè§ˆå™¨{% endblock %}

{% block content %}
<article class="paper-detail">
    <nav class="breadcrumb">
        <a href="{{ url_for('index') }}">ğŸ  é¦–é¡µ</a>
        <span class="separator">/</span>
        <a href="{{ url_for('category', category_id=paper.primary_category) }}">{{ paper.primary_category }}</a>
        <span class="separator">/</span>
        <span>è®ºæ–‡è¯¦æƒ…</span>
    </nav>
    
    <header class="paper-detail-header">
        <h1>{{ paper.title }}</h1>
        
        <div class="paper-detail-meta">
            <div class="meta-item">
                <span class="meta-label">ğŸ“… æäº¤æ—¶é—´</span>
                <span class="meta-value">{{ paper.published | format_date }}</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">ğŸ”„ æ›´æ–°æ—¶é—´</span>
                <span class="meta-value">{{ paper.updated | format_date }}</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">ğŸ“‚ åˆ†ç±»</span>
                <div class="meta-value tags">
                    {% for cat in paper.categories %}
                    <a href="{{ url_for('category', category_id=cat) }}" class="tag">{{ cat }}</a>
                    {% endfor %}
                </div>
            </div>
            <div class="meta-item">
                <span class="meta-label">ğŸ”— arXiv ID</span>
                <span class="meta-value mono">{{ paper.arxiv_id }}</span>
            </div>
        </div>
    </header>
    
    <section class="paper-section">
        <h2>ğŸ‘¥ ä½œè€…</h2>
        <div class="authors-list">
            {% for author in paper.authors %}
            <span class="author-name">{{ author }}</span>
            {% endfor %}
        </div>
        {% if paper.affiliations %}
        <div class="affiliations-list">
            <strong>ğŸ›ï¸ æœºæ„ï¼š</strong>
            {% for affil in paper.affiliations %}
            <span class="affiliation">{{ affil }}</span>{% if not loop.last %}, {% endif %}
            {% endfor %}
        </div>
        {% endif %}
    </section>
    
    <section class="paper-section">
        <h2>ğŸ“ æ‘˜è¦</h2>
        <div class="abstract-content">
            {{ paper.summary }}
        </div>
    </section>
    
    <section class="paper-section">
        <h2>ğŸ“ é“¾æ¥</h2>
        <div class="paper-links">
            <a href="{{ paper.pdf_url }}" target="_blank" rel="noopener" class="btn btn-lg btn-primary">
                ğŸ“¥ ä¸‹è½½ PDF
            </a>
            <a href="{{ paper.abs_url }}" target="_blank" rel="noopener" class="btn btn-lg btn-secondary">
                ğŸ”— arXiv é¡µé¢
            </a>
        </div>
    </section>
    
    <section class="paper-section">
        <h2>ğŸ“‹ BibTeX å¼•ç”¨</h2>
        <div class="bibtex-container">
            <pre class="bibtex-code" id="bibtex-content">{{ bibtex }}</pre>
            <button class="btn btn-copy" id="copy-btn" onclick="copyBibtex()">
                ğŸ“‹ ä¸€é”®å¤åˆ¶
            </button>
        </div>
    </section>
</article>
{% endblock %}

{% block extra_js %}
<script>
function copyBibtex() {
    const bibtexContent = document.getElementById('bibtex-content').textContent;
    const btn = document.getElementById('copy-btn');
    
    navigator.clipboard.writeText(bibtexContent).then(() => {
        const originalText = btn.textContent;
        btn.textContent = 'âœ… å·²å¤åˆ¶!';
        btn.classList.add('copied');
        
        setTimeout(() => {
            btn.textContent = originalText;
            btn.classList.remove('copied');
        }, 2000);
    }).catch(err => {
        console.error('å¤åˆ¶å¤±è´¥:', err);
        // é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨ textarea
        const textarea = document.createElement('textarea');
        textarea.value = bibtexContent;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        
        btn.textContent = 'âœ… å·²å¤åˆ¶!';
        setTimeout(() => {
            btn.textContent = 'ğŸ“‹ ä¸€é”®å¤åˆ¶';
        }, 2000);
    });
}
</script>
{% endblock %}

